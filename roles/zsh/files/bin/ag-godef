#!/usr/bin/env bb
;; -*- mode: clojure; -*-
(require '[babashka.process :refer [process]])

;; Goの型や関数定義を検索するコマンド - Plan 9とGo言語のブログ https://blog.lufia.org/entry/2021/11/15/135843
(let [word (forst *command-line-args*)]
  (-> ["ag"
       "-G" "\\.go$"
       "--color"
       (format "((package|type|var)\\s+%s(?=\\W))|(func.*\\W%s\\()|((?<=\\W)%s *:?=)"
               word
               word
               word)]
      (process {:in :inherit})
      :out
      slurp
      println))
